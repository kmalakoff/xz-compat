<!DOCTYPE html><html class="default" lang="en" data-base="./"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>xz-compat</title><meta name="description" content="Documentation for xz-compat"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => window.app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><a href="index.html" class="title">xz-compat</a><div id="tsd-toolbar-links"></div><button id="tsd-search-trigger" class="tsd-widget" aria-label="Search"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-search"></use></svg></button><dialog id="tsd-search" aria-label="Search"><input role="combobox" id="tsd-search-input" aria-controls="tsd-search-results" aria-autocomplete="list" aria-expanded="true" autocapitalize="off" autocomplete="off" placeholder="Search the docs" maxLength="100"/><ul role="listbox" id="tsd-search-results"></ul><div id="tsd-search-status" aria-live="polite" aria-atomic="true"><div>Preparing search index...</div></div></dialog><a href="#" class="tsd-widget menu" id="tsd-toolbar-menu-trigger" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h1>xz-compat</h1></div><div class="tsd-panel tsd-typography"><h1 id="xz-compat" class="tsd-anchor-link">xz-compat<a href="#xz-compat" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p><strong>XZ Decompression Library</strong></p>
<p>xz-compat is a complete pure JavaScript implementation of XZ decompression with support for LZMA2 compression, BCJ filters (Branch Conversion for various CPU architectures), and Delta filtering. Compatible with Node.js 0.8+.</p>
<h2 id="features" class="tsd-anchor-link">Features<a href="#features" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li>✅ <strong>XZ Format Support</strong>: Full XZ container format decoding</li>
<li>✅ <strong>LZMA2 Decoder</strong>: Complete LZMA2 decompression implementation</li>
<li>✅ <strong>High-Level 7z API</strong>: Streamlined decoding for 7z files with automatic native acceleration</li>
<li>✅ <strong>BCJ Filters</strong>: Branch conversion for improved compression on executables
<ul>
<li>x86 (32-bit)</li>
<li>ARM (32-bit)</li>
<li>ARM64 / AArch64</li>
<li>ARM Thumb</li>
<li>PowerPC</li>
<li>SPARC</li>
<li>IA64 / Itanium</li>
</ul>
</li>
<li>✅ <strong>Delta Filter</strong>: Byte-level delta encoding</li>
<li>✅ <strong>Streaming &amp; Sync</strong>: Both streaming transforms and synchronous decoding</li>
<li>✅ <strong>Node 0.8+</strong>: Works on legacy Node.js versions</li>
<li>✅ <strong>Native Acceleration</strong>: Optional lzma-native on Node.js 10+ for 3-5x performance boost</li>
</ul>
<h2 id="installation" class="tsd-anchor-link">Installation<a href="#installation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="bash"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">xz-compat</span>
</code><button type="button">Copy</button></pre>

<h3 id="optional-native-acceleration" class="tsd-anchor-link">Optional Native Acceleration<a href="#optional-native-acceleration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>For Node.js 10+, install <code>lzma-native</code> for automatic performance boost:</p>
<pre><code class="bash"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">lzma-native</span>
</code><button type="button">Copy</button></pre>

<p>This provides 3-5x faster decompression. The library automatically detects and uses native bindings when available, falling back to pure JavaScript on older Node versions, when installation fails, or when disabled via <code>LZMA_NATIVE_DISABLE=1</code>.</p>
<h2 id="quick-start" class="tsd-anchor-link">Quick Start<a href="#quick-start" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><h3 id="xz-decompression-self-describing-format" class="tsd-anchor-link">XZ Decompression (Self-describing format)<a href="#xz-decompression-self-describing-format" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="javascript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">readFileSync</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;fs&#39;</span><span class="hl-1">;</span><br/><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">decodeXZ</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;xz-compat&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">compressedData</span><span class="hl-1"> = </span><span class="hl-0">readFileSync</span><span class="hl-1">(</span><span class="hl-2">&#39;file.xz&#39;</span><span class="hl-1">);</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">decompressedData</span><span class="hl-1"> = </span><span class="hl-0">decodeXZ</span><span class="hl-1">(</span><span class="hl-4">compressedData</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Decompressed:&#39;</span><span class="hl-1">, </span><span class="hl-4">decompressedData</span><span class="hl-1">.</span><span class="hl-0">toString</span><span class="hl-1">());</span>
</code><button type="button">Copy</button></pre>

<h3 id="streaming-xz-decompression" class="tsd-anchor-link">Streaming XZ Decompression<a href="#streaming-xz-decompression" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="javascript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">createReadStream</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;fs&#39;</span><span class="hl-1">;</span><br/><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">createXZDecoder</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;xz-compat&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">input</span><span class="hl-1"> = </span><span class="hl-0">createReadStream</span><span class="hl-1">(</span><span class="hl-2">&#39;file.xz&#39;</span><span class="hl-1">);</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">decoder</span><span class="hl-1"> = </span><span class="hl-0">createXZDecoder</span><span class="hl-1">();</span><br/><br/><span class="hl-4">input</span><span class="hl-1">.</span><span class="hl-0">pipe</span><span class="hl-1">(</span><span class="hl-4">decoder</span><span class="hl-1">);</span><br/><span class="hl-4">decoder</span><span class="hl-1">.</span><span class="hl-0">on</span><span class="hl-1">(</span><span class="hl-2">&#39;data&#39;</span><span class="hl-1">, (</span><span class="hl-4">chunk</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Decompressed chunk:&#39;</span><span class="hl-1">, </span><span class="hl-4">chunk</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<h3 id="7z-lzmalzma2-decompression-high-level-api" class="tsd-anchor-link">7z LZMA/LZMA2 Decompression (High-level API)<a href="#7z-lzmalzma2-decompression-high-level-api" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="javascript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">decode7zLzma2</span><span class="hl-1">, </span><span class="hl-4">decode7zLzma</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;xz-compat&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-7">// Decompress LZMA2 from a 7z file (properties extracted separately)</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">lzma2Data</span><span class="hl-1"> = </span><span class="hl-0">readFileSync</span><span class="hl-1">(</span><span class="hl-2">&#39;data.7z&#39;</span><span class="hl-1">);</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">lzma2Properties</span><span class="hl-1"> = </span><span class="hl-7">/* from 7z folder structure */</span><span class="hl-1">;</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">decompressed</span><span class="hl-1"> = </span><span class="hl-0">decode7zLzma2</span><span class="hl-1">(</span><span class="hl-4">lzma2Data</span><span class="hl-1">, </span><span class="hl-4">lzma2Properties</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<h3 id="lzmalzma2-low-level-api" class="tsd-anchor-link">LZMA/LZMA2 (Low-level API)<a href="#lzmalzma2-low-level-api" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="javascript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">decodeLzma2</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;xz-compat&#39;</span><span class="hl-1">;</span><br/><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">writeFileSync</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;fs&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">lzma2Data</span><span class="hl-1"> = </span><span class="hl-0">readFileSync</span><span class="hl-1">(</span><span class="hl-2">&#39;data.lzma2&#39;</span><span class="hl-1">);</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">chunks</span><span class="hl-1"> = [];</span><br/><br/><span class="hl-0">decodeLzma2</span><span class="hl-1">(</span><span class="hl-4">lzma2Data</span><span class="hl-1">, </span><span class="hl-4">lzma2Properties</span><span class="hl-1">, </span><span class="hl-4">expectedSize</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-0">write</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">chunk</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">chunks</span><span class="hl-1">.</span><span class="hl-0">push</span><span class="hl-1">(</span><span class="hl-4">chunk</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">decompressed</span><span class="hl-1"> = </span><span class="hl-4">Buffer</span><span class="hl-1">.</span><span class="hl-0">concat</span><span class="hl-1">(</span><span class="hl-4">chunks</span><span class="hl-1">);</span><br/><span class="hl-0">writeFileSync</span><span class="hl-1">(</span><span class="hl-2">&#39;output.bin&#39;</span><span class="hl-1">, </span><span class="hl-4">decompressed</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<h3 id="using-bcj-filters-directly" class="tsd-anchor-link">Using BCJ Filters Directly<a href="#using-bcj-filters-directly" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="javascript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">decodeBcj</span><span class="hl-1">, </span><span class="hl-4">decodeBcjArm</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;xz-compat&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-7">// Decode x86 BCJ filtered data</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">x86Data</span><span class="hl-1"> = </span><span class="hl-0">readFileSync</span><span class="hl-1">(</span><span class="hl-2">&#39;filtered-x86.bin&#39;</span><span class="hl-1">);</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">unfiltered</span><span class="hl-1"> = </span><span class="hl-0">decodeBcj</span><span class="hl-1">(</span><span class="hl-4">x86Data</span><span class="hl-1">);</span><br/><br/><span class="hl-7">// Decode ARM BCJ filtered data</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">armData</span><span class="hl-1"> = </span><span class="hl-0">readFileSync</span><span class="hl-1">(</span><span class="hl-2">&#39;filtered-arm.bin&#39;</span><span class="hl-1">);</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">unfilteredArm</span><span class="hl-1"> = </span><span class="hl-0">decodeBcjArm</span><span class="hl-1">(</span><span class="hl-4">armData</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<h2 id="api-reference" class="tsd-anchor-link">API Reference<a href="#api-reference" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><h3 id="high-level-apis-recommended" class="tsd-anchor-link">High-Level APIs (Recommended)<a href="#high-level-apis-recommended" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><h4 id="xz-decompression" class="tsd-anchor-link">XZ Decompression<a href="#xz-decompression" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><h4 id="" class="tsd-anchor-link"><code>decodeXZ(buffer: Buffer): Buffer</code></h4><p>Synchronously decompresses XZ format data.</p>
<ul>
<li><strong>Automatic native acceleration</strong>: Uses lzma-native when available on Node 10+</li>
<li><strong>Self-describing</strong>: Properties embedded in XZ format</li>
</ul>
<h4 id="-1" class="tsd-anchor-link"><code>createXZDecoder(): Transform</code><a href="#-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Creates a streaming Transform for XZ decompression.</p>
<ul>
<li>Automatically uses native acceleration when available</li>
</ul>
<h4 id="7z-lzmalzma2-decompression" class="tsd-anchor-link">7z LZMA/LZMA2 Decompression<a href="#7z-lzmalzma2-decompression" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><h4 id="-2" class="tsd-anchor-link"><code>decode7zLzma2(data: Buffer, properties: Buffer, unpackSize?: number): Buffer</code><a href="#-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Decompresses LZMA2 data from a 7z file.</p>
<ul>
<li>Accepts properties separately (matching 7z format)</li>
<li>Tries native acceleration via lzma-native automatically</li>
<li>Falls back to pure JavaScript if native unavailable</li>
</ul>
<h4 id="-3" class="tsd-anchor-link"><code>decode7zLzma(data: Buffer, properties: Buffer, unpackSize: number): Buffer</code><a href="#-3" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Decompresses LZMA1 data from a 7z file.</p>
<ul>
<li>Accepts 5-byte properties separately</li>
<li>Tries native acceleration automatically</li>
</ul>
<h3 id="low-level-apis-specialized-use" class="tsd-anchor-link">Low-Level APIs (Specialized Use)<a href="#low-level-apis-specialized-use" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><h4 id="lzma-decompression" class="tsd-anchor-link">LZMA Decompression<a href="#lzma-decompression" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><h4 id="-4" class="tsd-anchor-link"><code>decodeLzma(buffer: Buffer, properties: Buffer, outSize: number, sink?: OutputSink): Buffer</code><a href="#-4" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Synchronously decodes LZMA1 compressed data.</p>
<ul>
<li>Low-level API for raw LZMA data</li>
<li>Requires separate properties and output size</li>
</ul>
<h4 id="-5" class="tsd-anchor-link"><code>createLzmaDecoder(properties: Buffer, outSize: number): Transform</code><a href="#-5" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Creates a streaming Transform for LZMA1 decompression.</p>
<h4 id="lzma2-decompression" class="tsd-anchor-link">LZMA2 Decompression<a href="#lzma2-decompression" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><h4 id="-6" class="tsd-anchor-link"><code>decodeLzma2(buffer: Buffer, properties: Buffer, unpackSize: number, sink?: OutputSink): Buffer</code><a href="#-6" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Synchronously decodes LZMA2 compressed data.</p>
<h4 id="-7" class="tsd-anchor-link"><code>createLzma2Decoder(properties: Buffer, unpackSize?: number): Transform</code><a href="#-7" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Creates a streaming Transform for LZMA2 decompression.</p>
<h3 id="bcj-filters" class="tsd-anchor-link">BCJ Filters<a href="#bcj-filters" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Branch Conversion (BCJ) filters improve compression of executables by converting relative branch addresses to absolute addresses, creating more repetitive patterns.</p>
<p>All BCJ filters follow the same interface:</p>
<ul>
<li><code>decodeBcj*(buffer: Buffer, properties?: Buffer, unpackSize?: number): Buffer</code></li>
<li><code>createBcj*Decoder(properties?: Buffer, unpackSize?: number): Transform</code></li>
</ul>
<p>Supported BCJ filters:</p>
<ul>
<li><code>decodeBcj</code> / <code>createBcjDecoder</code> - x86 (32-bit)</li>
<li><code>decodeBcjArm</code> / <code>createBcjArmDecoder</code> - ARM (32-bit)</li>
<li><code>decodeBcjArm64</code> / <code>createBcjArm64Decoder</code> - ARM64 / AArch64</li>
<li><code>decodeBcjArmt</code> / <code>createBcjArmtDecoder</code> - ARM Thumb</li>
<li><code>decodeBcjPpc</code> / <code>createBcjPpcDecoder</code> - PowerPC</li>
<li><code>decodeBcjSparc</code> / <code>createBcjSparcDecoder</code> - SPARC</li>
<li><code>decodeBcjIa64</code> / <code>createBcjIa64Decoder</code> - IA64 / Itanium</li>
</ul>
<h3 id="delta-filter" class="tsd-anchor-link">Delta Filter<a href="#delta-filter" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><h4 id="-8" class="tsd-anchor-link"><code>decodeDelta(buffer: Buffer, distance?: Buffer): Buffer</code><a href="#-8" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Decodes Delta filtered data (inter-byte differences).</p>
<h2 id="use-cases" class="tsd-anchor-link">Use Cases<a href="#use-cases" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><h3 id="1-decompressing-xz-archives" class="tsd-anchor-link">1. Decompressing XZ Archives<a href="#1-decompressing-xz-archives" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="javascript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">createReadStream</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;fs&#39;</span><span class="hl-1">;</span><br/><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">createXZDecoder</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;xz-compat&#39;</span><span class="hl-1">;</span><br/><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">pipeline</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;stream/promises&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-5">function</span><span class="hl-1"> </span><span class="hl-0">decompressXZ</span><span class="hl-1">(</span><span class="hl-4">inputPath</span><span class="hl-1">, </span><span class="hl-4">outputPath</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">pipeline</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-0">createReadStream</span><span class="hl-1">(</span><span class="hl-4">inputPath</span><span class="hl-1">),</span><br/><span class="hl-1">    </span><span class="hl-0">createXZDecoder</span><span class="hl-1">(),</span><br/><span class="hl-1">    </span><span class="hl-0">createWriteStream</span><span class="hl-1">(</span><span class="hl-4">outputPath</span><span class="hl-1">)</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<h3 id="2-working-with-lzma-compressed-files" class="tsd-anchor-link">2. Working with LZMA Compressed Files<a href="#2-working-with-lzma-compressed-files" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="javascript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">decodeLzma2</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;xz-compat&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-7">// Decompress raw LZMA2 stream</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">data</span><span class="hl-1"> = </span><span class="hl-0">readFileSync</span><span class="hl-1">(</span><span class="hl-2">&#39;data.lzma2&#39;</span><span class="hl-1">);</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">chunks</span><span class="hl-1"> = [];</span><br/><br/><span class="hl-0">decodeLzma2</span><span class="hl-1">(</span><span class="hl-4">data</span><span class="hl-1">, </span><span class="hl-4">propertiesBuffer</span><span class="hl-1">, </span><span class="hl-4">uncompressedSize</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-0">write</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">chunk</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">chunks</span><span class="hl-1">.</span><span class="hl-0">push</span><span class="hl-1">(</span><span class="hl-4">chunk</span><span class="hl-1">)</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">result</span><span class="hl-1"> = </span><span class="hl-4">Buffer</span><span class="hl-1">.</span><span class="hl-0">concat</span><span class="hl-1">(</span><span class="hl-4">chunks</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<h3 id="3-batch-processing-compressed-files" class="tsd-anchor-link">3. Batch Processing Compressed Files<a href="#3-batch-processing-compressed-files" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="javascript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">decodeXZ</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;xz-compat&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">function</span><span class="hl-1"> </span><span class="hl-0">processXZFiles</span><span class="hl-1">(</span><span class="hl-4">filePaths</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">filePaths</span><span class="hl-1">.</span><span class="hl-0">map</span><span class="hl-1">(</span><span class="hl-4">file</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">compressed</span><span class="hl-1"> = </span><span class="hl-0">readFileSync</span><span class="hl-1">(</span><span class="hl-4">file</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">decompressed</span><span class="hl-1"> = </span><span class="hl-0">decodeXZ</span><span class="hl-1">(</span><span class="hl-4">compressed</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-7">// Process decompressed data</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-0">processData</span><span class="hl-1">(</span><span class="hl-4">decompressed</span><span class="hl-1">);</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<h2 id="technical-details" class="tsd-anchor-link">Technical Details<a href="#technical-details" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><h3 id="xz-format-structure" class="tsd-anchor-link">XZ Format Structure<a href="#xz-format-structure" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>XZ is a container format that wraps LZMA2 compressed data:</p>
<ol>
<li>Stream Header</li>
<li>One or more Blocks (each with Block Header + Compressed Data)</li>
<li>Index (records block positions)</li>
<li>Stream Footer</li>
</ol>
<p>Each Block can contain:</p>
<ul>
<li>A chain of preprocessing filters (Delta, BCJ)</li>
<li>LZMA2 compression</li>
</ul>
<h3 id="bcj-filter-algorithm" class="tsd-anchor-link">BCJ Filter Algorithm<a href="#bcj-filter-algorithm" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>BCJ filters convert branch instructions in executable code:</p>
<p><strong>x86 Example:</strong></p>
<ul>
<li>Original: <code>E8 xx xx xx xx</code> (CALL with relative offset)</li>
<li>Converted: <code>E8 aa aa aa aa</code> (CALL with absolute address)</li>
</ul>
<p>This creates more repetitive patterns for better LZMA2 compression.</p>
<h3 id="reference-implementation" class="tsd-anchor-link">Reference Implementation<a href="#reference-implementation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>This implementation is based on the reference XZ Utils (XZ Embedded) codebase:</p>
<ul>
<li><a href="https://github.com/tukaani-project/xz">XZ Utils GitHub</a></li>
<li>Filter algorithms match the xz embedded reference implementations</li>
</ul>
<h2 id="compatibility" class="tsd-anchor-link">Compatibility<a href="#compatibility" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><strong>Node.js</strong>: 0.8 and above</li>
<li><strong>Browser</strong>: Not tested (designed for Node.js)</li>
<li><strong>Dependencies</strong>: None (pure JavaScript)</li>
</ul>
<h2 id="differences-from-native-xz" class="tsd-anchor-link">Differences from Native XZ<a href="#differences-from-native-xz" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>This is a <strong>decompression-only</strong> implementation focused on compatibility and ease of use:</p>
<ul>
<li>No compression support (only decompression)</li>
<li>Simplified streaming interface</li>
<li>Pure JavaScript (no native bindings)</li>
<li>Optimized for readability and maintainability</li>
</ul>
<h2 id="performance" class="tsd-anchor-link">Performance<a href="#performance" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Performance characteristics:</p>
<ul>
<li><strong>Synchronous</strong>: Suitable for small to medium files</li>
<li><strong>Streaming</strong>: Memory-efficient for large files</li>
<li><strong>Trade-off</strong>: Pure JavaScript may be slower than native implementations</li>
<li><strong>BCJ Decoding</strong>: Optimized reference algorithm implementations</li>
</ul>
<h2 id="license" class="tsd-anchor-link">License<a href="#license" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>MIT</p>
<h2 id="contributing" class="tsd-anchor-link">Contributing<a href="#contributing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Contributions welcome! Please ensure tests pass:</p>
<pre><code class="bash"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">test</span>
</code><button type="button">Copy</button></pre>

<h2 id="references" class="tsd-anchor-link">References<a href="#references" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><a href="https://tukaani.org/xz/xz-file-format.txt">XZ Format Specification</a></li>
<li><a href="https://www.7-zip.org/sdk.html">LZMA SDK</a></li>
<li><a href="https://tukaani.org/xz/">XZ Utils</a></li>
</ul>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg><h3>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg><h3>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#xz-compat"><span>xz-<wbr/>compat</span></a><ul><li><a href="#features"><span>Features</span></a></li><li><a href="#installation"><span>Installation</span></a></li><li><ul><li><a href="#optional-native-acceleration"><span>Optional <wbr/>Native <wbr/>Acceleration</span></a></li></ul></li><li><a href="#quick-start"><span>Quick <wbr/>Start</span></a></li><li><ul><li><a href="#xz-decompression-self-describing-format"><span>XZ <wbr/>Decompression (<wbr/>Self-<wbr/>describing format)</span></a></li><li><a href="#streaming-xz-decompression"><span>Streaming <wbr/>XZ <wbr/>Decompression</span></a></li><li><a href="#7z-lzmalzma2-decompression-high-level-api"><span>7z <wbr/>LZMA/<wbr/>LZMA2 <wbr/>Decompression (<wbr/>High-<wbr/>level <wbr/>API)</span></a></li><li><a href="#lzmalzma2-low-level-api"><span>LZMA/<wbr/>LZMA2 (<wbr/>Low-<wbr/>level <wbr/>API)</span></a></li><li><a href="#using-bcj-filters-directly"><span>Using <wbr/>BCJ <wbr/>Filters <wbr/>Directly</span></a></li></ul></li><li><a href="#api-reference"><span>API <wbr/>Reference</span></a></li><li><ul><li><a href="#high-level-apis-recommended"><span>High-<wbr/>Level <wbr/>AP<wbr/>Is (<wbr/>Recommended)</span></a></li><li><ul><li><a href="#xz-decompression"><span>XZ <wbr/>Decompression</span></a></li><li><a href="#"><span></span></a></li><li><a href="#-1"><span></span></a></li><li><a href="#7z-lzmalzma2-decompression"><span>7z <wbr/>LZMA/<wbr/>LZMA2 <wbr/>Decompression</span></a></li><li><a href="#-2"><span></span></a></li><li><a href="#-3"><span></span></a></li></ul></li><li><a href="#low-level-apis-specialized-use"><span>Low-<wbr/>Level <wbr/>AP<wbr/>Is (<wbr/>Specialized <wbr/>Use)</span></a></li><li><ul><li><a href="#lzma-decompression"><span>LZMA <wbr/>Decompression</span></a></li><li><a href="#-4"><span></span></a></li><li><a href="#-5"><span></span></a></li><li><a href="#lzma2-decompression"><span>LZMA2 <wbr/>Decompression</span></a></li><li><a href="#-6"><span></span></a></li><li><a href="#-7"><span></span></a></li></ul></li><li><a href="#bcj-filters"><span>BCJ <wbr/>Filters</span></a></li><li><a href="#delta-filter"><span>Delta <wbr/>Filter</span></a></li><li><ul><li><a href="#-8"><span></span></a></li></ul></li></ul></li><li><a href="#use-cases"><span>Use <wbr/>Cases</span></a></li><li><ul><li><a href="#1-decompressing-xz-archives"><span>1. <wbr/>Decompressing <wbr/>XZ <wbr/>Archives</span></a></li><li><a href="#2-working-with-lzma-compressed-files"><span>2. <wbr/>Working with <wbr/>LZMA <wbr/>Compressed <wbr/>Files</span></a></li><li><a href="#3-batch-processing-compressed-files"><span>3. <wbr/>Batch <wbr/>Processing <wbr/>Compressed <wbr/>Files</span></a></li></ul></li><li><a href="#technical-details"><span>Technical <wbr/>Details</span></a></li><li><ul><li><a href="#xz-format-structure"><span>XZ <wbr/>Format <wbr/>Structure</span></a></li><li><a href="#bcj-filter-algorithm"><span>BCJ <wbr/>Filter <wbr/>Algorithm</span></a></li><li><a href="#reference-implementation"><span>Reference <wbr/>Implementation</span></a></li></ul></li><li><a href="#compatibility"><span>Compatibility</span></a></li><li><a href="#differences-from-native-xz"><span>Differences from <wbr/>Native <wbr/>XZ</span></a></li><li><a href="#performance"><span>Performance</span></a></li><li><a href="#license"><span>License</span></a></li><li><a href="#contributing"><span>Contributing</span></a></li><li><a href="#references"><span>References</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html">xz-compat</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
